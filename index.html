<!doctype HTML>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Location Based AR.js demo</title>
    <!--<script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>-->
    <script src='https://aframe.io/releases/1.0.4/aframe.min.js'></script>
    <script src="https://raw.githack.com/jeromeetienne/AR.js/master/aframe/build/aframe-ar.min.js"></script>
    <script src="https://raw.githack.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
    <script>

      window.onload = () => {   
        let scene = document.querySelector('a-scene');

        navigator.geolocation.getCurrentPosition((position) => {
          console.log(position.coords.latitude+" "+position.coords.longitude);
          document.querySelector('a-text').setAttribute('gps-entity-place', `latitude: ${position.coords.latitude}; longitude: ${position.coords.longitude};`);

          //document.querySelector('a-gltf-model').setAttribute('gps-entity-place', `latitude: ${position.coords.latitude}; longitude: ${position.coords.longitude};`);
          //document.querySelector('a-entity').setAttribute('gps-entity-place', `latitude: ${position.coords.latitude}; longitude: ${position.coords.longitude};`);
          let model = document.createElement('a-entity');
          model.setAttribute('gps-entity-place', `latitude: ${position.coords.latitude}; longitude: ${position.coords.longitude};`);
          model.setAttribute('gltf-model', './models/cone.gltf');
          model.setAttribute('rotation', '0 180 0');

          model.setAttribute('animation-mixer', '');
          model.setAttribute('scale', '0.5 0.5 0.5');

          scene.appendChild(model);

          let model2 = document.createElement('a-entity');
          model2.setAttribute('gps-entity-place', `latitude: ${position.coords.latitude}; longitude: ${position.coords.longitude};`);
          model2.setAttribute('gltf-model', './models/cube.gltf');
          model2.setAttribute('material',"color: white; shader: flat; src: ./textures/metal.jpg");
          model2.setAttribute('src',"./textures/metal.jpg");
          model2.setAttribute('rotation', '0 180 0');
          model2.setAttribute('animation-mixer', '');
          model2.setAttribute('scale', '0.3 0.4 0.4');

          scene.appendChild(model2);
        });
      }
    </script>
  </head>

  <body style="margin: 0; overflow: hidden;">
    <a-scene
      vr-mode-ui="enabled: false"
      embedded
      arjs="sourceType: webcam; debugUIEnabled: true;"
    >
      <a-text
        value="No markers around"
        look-at="[gps-camera]"
        scale="5 5 5"
      ></a-text>

      <a-camera gps-camera rotation-reader> </a-camera>
    </a-scene>
  </body>
</html>
